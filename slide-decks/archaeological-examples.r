# -----------------------------------------------------------------
# דוגמאות מחקר ארכיאולוגי המשלבות Git ו-AI
# -----------------------------------------------------------------

# ================================================================
# דוגמה 1: ניתוח התפלגות כלי חרס לפי תקופות
# ================================================================

# יצירת נתוני דוגמה של ממצאי כלי חרס
library(tidyverse)

set.seed(123) # לשחזוריות

# יצירת מסד נתונים של כלי חרס מדגמיים
pottery_data <- tibble(
  id = 1:300,
  site = sample(c("תל דור", "מגידו", "חצור", "לכיש"), 300, replace = TRUE),
  period = sample(c("תקופת הברונזה", "תקופת הברזל", "התקופה הפרסית", 
                   "התקופה ההלניסטית", "התקופה הרומית"), 300, 
                 prob = c(0.3, 0.25, 0.15, 0.2, 0.1), replace = TRUE),
  type = sample(c("קערה", "קנקן", "פך", "נר", "פיטס"), 300, replace = TRUE),
  diameter_cm = rnorm(300, mean = 20, sd = 8) %>% round(1),
  height_cm = rnorm(300, mean = 15, sd = 6) %>% round(1),
  complete = sample(c(TRUE, FALSE), 300, prob = c(0.3, 0.7), replace = TRUE),
  decorations = sample(c("צבוע", "מחורץ", "חלק", "מוטבע"), 300, replace = TRUE)
)

# שמירת הנתונים (נניח שאחרי זה נבצע git add ו-git commit)
write_csv(pottery_data, "pottery_data.csv")

# -----------------------------------------------------------------
# כעת, באמצעות gptstudio, אפשר לבקש ניתוח של הנתונים:
# סמנו את הקוד הבא והשתמשו ב- Addins > gptstudio > Chat in Source
# -----------------------------------------------------------------

# ניתוח בסיסי של התפלגות כלי החרס
pottery_data %>%
  count(period, type) %>%
  group_by(period) %>%
  mutate(percentage = n / sum(n) * 100)

# ויזואליזציה של התפלגות כלי החרס לפי תקופות
ggplot(pottery_data, aes(x = period, fill = type)) +
  geom_bar(position = "stack")

# ================================================================
# דוגמה 2: ניתוח מרחבי של ממצאים
# ================================================================

# יצירת נתוני דוגמה של ממצאים עם קואורדינטות מרחביות
spatial_finds <- tibble(
  id = 1:500,
  x_coord = runif(500, 0, 100),  # קואורדינטות מזרח-מערב במטרים
  y_coord = runif(500, 0, 80),   # קואורדינטות צפון-דרום במטרים
  depth_cm = runif(500, 10, 200), # עומק במטרים
  material = sample(c("חרס", "אבן", "מתכת", "עצם", "זכוכית"), 
                   500, replace = TRUE),
  period = sample(c("תקופת הברונזה", "תקופת הברזל", "התקופה הפרסית", 
                   "התקופה ההלניסטית", "התקופה הרומית"), 500, 
                 prob = c(0.25, 0.3, 0.15, 0.2, 0.1), replace = TRUE),
  context = sample(c("קבר", "מבנה מגורים", "מבנה ציבורי", "רחוב", "חצר"), 
                  500, replace = TRUE)
)

# שמירת הנתונים (נניח שאחרי זה נבצע git add ו-git commit)
write_csv(spatial_finds, "spatial_finds.csv")

# -----------------------------------------------------------------
# כעת, באמצעות gptstudio, אפשר לבקש ניתוח מרחבי של הנתונים:
# סמנו את הקוד הבא והשתמשו ב- Addins > gptstudio > Chat in Source
# -----------------------------------------------------------------

# ניתוח בסיסי של התפלגות הממצאים לפי עומק ותקופה
spatial_finds %>%
  group_by(period) %>%
  summarize(
    mean_depth = mean(depth_cm),
    sd_depth = sd(depth_cm),
    count = n()
  )

# ויזואליזציה פשוטה של הממצאים במרחב
ggplot(spatial_finds, aes(x = x_coord, y = y_coord, color = period)) +
  geom_point()

# ================================================================
# דוגמה 3: ניתוח תאריכי פחמן 14
# ================================================================

# יצירת נתוני דוגמה של תאריכי פחמן 14
c14_dates <- tibble(
  sample_id = paste0("C14-", 1:50),
  site = sample(c("תל דור", "מגידו", "חצור", "לכיש"), 50, replace = TRUE),
  context = sample(c("קבר", "מבנה מגורים", "מבנה ציבורי", "שכבת חורבן"), 
                  50, replace = TRUE),
  material = sample(c("פחם", "עצם", "זרע", "עץ"), 50, replace = TRUE),
  bp_date = sample(seq(2000, 4000, by = 10), 50),  # תאריך לפני ההווה
  bp_error = sample(20:60, 50, replace = TRUE)    # טווח שגיאה
)

# שמירת הנתונים (נניח שאחרי זה נבצע git add ו-git commit)
write_csv(c14_dates, "c14_dates.csv")

# -----------------------------------------------------------------
# כעת, באמצעות gptstudio, אפשר לבקש עזרה בכיול תאריכי פחמן 14:
# סמנו את הטקסט הבא והשתמשו ב- Addins > gptstudio > Chat in Source
# -----------------------------------------------------------------

# אני צריך לכייל את תאריכי פחמן 14 לתאריכים קלנדריים
# ולייצר גרף של התפלגות התאריכים לפי אתר.
# איך אוכל לעשות זאת ב-R? אילו חבילות כדאי להשתמש?

# ================================================================
# דוגמה 4: דוח מחקר אוטומטי באמצעות R Markdown
# ================================================================

# זה תוכן לדוגמה של קובץ R Markdown שאפשר ליצור ולשמור כ- pottery_analysis.Rmd
# לאחר מכן אפשר להשתמש ב-gptstudio להרחבת הניתוח והדוח

# ```r
# ---
# title: "ניתוח כלי חרס מתל דור"
# author: "שם החוקר"
# date: "`r Sys.Date()`"
# output: 
#   html_document:
#     dir: rtl
#     toc: yes
#     toc_float: yes
# ---
# 
# ```{r setup, include=FALSE}
# knitr::opts_chunk$set(echo = TRUE)
# library(tidyverse)
# library(kableExtra)
# ```
# 
# ## מבוא
# 
# דוח זה מציג ניתוח של כלי חרס שנמצאו בחפירות תל דור בעונות 2020-2022.
# 
# ## נתונים
# 
# ```{r load-data}
# pottery_data <- read_csv("pottery_data.csv")
# glimpse(pottery_data)
# ```
# 
# ## ניתוח בסיסי
# 
# ```{r basic-analysis}
# # סיכום כמותי לפי תקופות
# period_summary <- pottery_data %>%
#   count(period) %>%
#   mutate(percentage = n / sum(n) * 100)
# 
# kable(period_summary) %>%
#   kable_styling(bootstrap_options = c("striped", "hover"))
# ```
# 
# ## ויזואליזציה
# 
# ```{r visualization}
# ggplot(pottery_data, aes(x = period, fill = type)) +
#   geom_bar() +
#   theme_minimal() +
#   labs(title = "התפלגות סוגי כלי חרס לפי תקופות",
#        x = "תקופה",
#        y = "כמות",
#        fill = "סוג כלי") +
#   theme(axis.text.x = element_text(angle = 45, hjust = 1))
# ```
# 
# ## מסקנות
# 
# [כאן יש להוסיף מסקנות ראשוניות]
# 
# ```

# -----------------------------------------------------------------
# אפשר לבקש מ-gptstudio להשלים את חלק המסקנות:
# סמנו את הטקסט "[כאן יש להוסיף מסקנות ראשוניות]"
# והשתמשו ב- Addins > gptstudio > Chat in Source
# עם ההנחיה: "כתוב מסקנות ראשוניות לדוח בהתבסס על הניתוח הקודם"
# -----------------------------------------------------------------

# ================================================================
# דוגמה 5: תיעוד שילוב Git ו-AI ב-README.md
# ================================================================

# להלן דוגמה לתוכן README.md שמתעד את השימוש בכלים:

# ```markdown
# # ניתוח ממצאים ארכיאולוגיים מתל דור
# 
# מאגר זה מכיל את כל הנתונים, הקוד והדוחות הקשורים לניתוח ממצאים ארכיאולוגיים מתל דור.
# 
# ## מבנה המאגר
# 
# - `data/`: קבצי נתונים גולמיים ומעובדים
# - `code/`: סקריפטים של R לניתוח נתונים
# - `reports/`: דוחות ניתוח ב-R Markdown
# - `figures/`: תרשימים וויזואליזציות
# 
# ## שיטות מחקר
# 
# בפרויקט זה השתמשנו בשיטות הבאות:
# 
# - ניתוח סטטיסטי באמצעות R (גרסה 4.2.0) וחבילות tidyverse
# - בקרת גרסאות באמצעות Git ו-GitHub
# - סיוע בניתוח וכתיבת קוד באמצעות gptstudio (גרסה 0.3.0) המשתמש במודל GPT-4 של OpenAI
# 
# כל התוצאות והניתוחים שהתקבלו בסיוע AI עברו בדיקה ואימות ידני על ידי צוות המחקר.
# 
# ## שחזור הניתוח
# 
# כדי לשחזר את הניתוח, בצעו את הפעולות הבאות:
# 
# 1. שכפלו (clone) את המאגר למחשב המקומי שלכם
# 2. התקינו את חבילות R הנדרשות המפורטות בקובץ `dependencies.R`
# 3. הריצו את הסקריפטים בתיקיית `code/` לפי הסדר המספרי
# 
# ## שיתוף פעולה ותרומות
# 
# אנו מזמינים חוקרים להציע שיפורים ותוספות לניתוח. אנא צרו "fork" למאגר,
# בצעו את השינויים שלכם, ושלחו "pull request".
# 
# ## רישיון
# 
# נתונים וקוד זמינים תחת רישיון CC BY 4.0.
# ```

# -----------------------------------------------------------------
# אפשר לבקש מ-gptstudio להרחיב חלקים ספציפיים ב-README:
# לדוגמה, סמנו את החלק על "שיטות מחקר" והשתמשו ב-
# Addins > gptstudio > Chat in Source
# עם הנחיה כמו: "הרחב את החלק על שיטות המחקר וכלול פירוט על השיטות 
# הסטטיסטיות הספציפיות והאופן שבו AI שולב בתהליך"
# -----------------------------------------------------------------
